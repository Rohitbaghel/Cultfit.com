<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
   <style>
       #location-btn{
         
           background-color: white;
           color:blue;
           height:50px;
           font-size: 20px;
       }
   </style>
</head>
<body>
    <button id="location-btn">Get user location</button>
    <div id="output"></div>
</body>
</html>

<script>
 const btn = document.getElementById("location-btn")
 btn.addEventListener("click", () => {
     if(navigator.geolocation){       //if browser supported geolocation api
        navigator.geolocation.getCurrentPosition(onSuccess,onError)
     } 
     else{
         btn.innerText = "your browser not support"
     }

 })

 function onSuccess(position){
    //  console.log(position)
    let {latitude,longitude} = position.coords;
    // https://api.opencagedata.com/geocode/v1/json?q=LAT+LNG&key=YOUR-API-KEY
 fetch(`https://api.opencagedata.com/geocode/v1/json?q=${latitude}+${longitude}&key=c2ab82e7d6484f4fa91f9e16e7bd159f`)
//  .then(console.log)
//   .then(response => response.json()).then(result => console.log(result))

.then(response => response.json()).then(result => {
    let alldetails = result.results[0].components;
    // console.log(alldetails)
    let{city,postcode,state,country} = alldetails
    // console.log(city,postcode,state,country)
    btn.innerHTML =`${city} ${postcode}, ${state} ,${country}`
})

    


 }

 function onError(error){
     if(error.code == 1){
         btn.innerText = "you denied the request"
     }
     else if(error.code == 2){
         btn.innerText = "something went wrong"
     }
     btn.setAttribute("disabled",true)
 }
</script>
